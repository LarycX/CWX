{"version":3,"file":"audio.js","sources":["pages/index/logic/audio.js"],"sourcesContent":["const generateToneSamples = (durationMs, sampleRate, toneFreq) => {\n\tconst totalSamples = Math.floor((durationMs / 1000) * sampleRate)\n\tconst samples = new Array(totalSamples)\n\tconst amplitude = 0.6\n\tconst omega = (2 * Math.PI * toneFreq) / sampleRate\n\tfor (let i = 0; i < totalSamples; i += 1) {\n\t\tsamples[i] = Math.sin(omega * i) * amplitude\n\t}\n\treturn samples\n}\n\nconst generateSilenceSamples = (durationMs, sampleRate) => {\n\tconst totalSamples = Math.floor((durationMs / 1000) * sampleRate)\n\treturn new Array(totalSamples).fill(0)\n}\n\nconst buildMarkSamples = (mark, unitMs, sampleRate, toneFreq) => {\n\tconst markUnits = mark === '-' ? 3 : 1\n\tconst toneMs = unitMs * markUnits\n\treturn generateToneSamples(toneMs, sampleRate, toneFreq)\n}\n\nconst encodeWav = (samples, sampleRate) => {\n\tconst buffer = new ArrayBuffer(44 + samples.length * 2)\n\tconst view = new DataView(buffer)\n\tconst writeString = (offset, text) => {\n\t\tfor (let i = 0; i < text.length; i += 1) {\n\t\t\tview.setUint8(offset + i, text.charCodeAt(i))\n\t\t}\n\t}\n\twriteString(0, 'RIFF')\n\tview.setUint32(4, 36 + samples.length * 2, true)\n\twriteString(8, 'WAVE')\n\twriteString(12, 'fmt ')\n\tview.setUint32(16, 16, true)\n\tview.setUint16(20, 1, true)\n\tview.setUint16(22, 1, true)\n\tview.setUint32(24, sampleRate, true)\n\tview.setUint32(28, sampleRate * 2, true)\n\tview.setUint16(32, 2, true)\n\tview.setUint16(34, 16, true)\n\twriteString(36, 'data')\n\tview.setUint32(40, samples.length * 2, true)\n\tlet offset = 44\n\tfor (let i = 0; i < samples.length; i += 1) {\n\t\tconst sample = Math.max(-1, Math.min(1, samples[i]))\n\t\tview.setInt16(offset, sample < 0 ? sample * 0x8000 : sample * 0x7fff, true)\n\t\toffset += 2\n\t}\n\treturn buffer\n}\n\nexport {\n\tbuildMarkSamples,\n\tencodeWav,\n\tgenerateSilenceSamples,\n\tgenerateToneSamples\n}\n"],"names":["offset"],"mappings":";AAAA,MAAM,sBAAsB,CAAC,YAAY,YAAY,aAAa;AACjE,QAAM,eAAe,KAAK,MAAO,aAAa,MAAQ,UAAU;AAChE,QAAM,UAAU,IAAI,MAAM,YAAY;AACtC,QAAM,YAAY;AAClB,QAAM,QAAS,IAAI,KAAK,KAAK,WAAY;AACzC,WAAS,IAAI,GAAG,IAAI,cAAc,KAAK,GAAG;AACzC,YAAQ,CAAC,IAAI,KAAK,IAAI,QAAQ,CAAC,IAAI;AAAA,EACnC;AACD,SAAO;AACR;AAOK,MAAC,mBAAmB,CAAC,MAAM,QAAQ,YAAY,aAAa;AAChE,QAAM,YAAY,SAAS,MAAM,IAAI;AACrC,QAAM,SAAS,SAAS;AACxB,SAAO,oBAAoB,QAAQ,YAAY,QAAQ;AACxD;AAEK,MAAC,YAAY,CAAC,SAAS,eAAe;AAC1C,QAAM,SAAS,IAAI,YAAY,KAAK,QAAQ,SAAS,CAAC;AACtD,QAAM,OAAO,IAAI,SAAS,MAAM;AAChC,QAAM,cAAc,CAACA,SAAQ,SAAS;AACrC,aAAS,IAAI,GAAG,IAAI,KAAK,QAAQ,KAAK,GAAG;AACxC,WAAK,SAASA,UAAS,GAAG,KAAK,WAAW,CAAC,CAAC;AAAA,IAC5C;AAAA,EACD;AACD,cAAY,GAAG,MAAM;AACrB,OAAK,UAAU,GAAG,KAAK,QAAQ,SAAS,GAAG,IAAI;AAC/C,cAAY,GAAG,MAAM;AACrB,cAAY,IAAI,MAAM;AACtB,OAAK,UAAU,IAAI,IAAI,IAAI;AAC3B,OAAK,UAAU,IAAI,GAAG,IAAI;AAC1B,OAAK,UAAU,IAAI,GAAG,IAAI;AAC1B,OAAK,UAAU,IAAI,YAAY,IAAI;AACnC,OAAK,UAAU,IAAI,aAAa,GAAG,IAAI;AACvC,OAAK,UAAU,IAAI,GAAG,IAAI;AAC1B,OAAK,UAAU,IAAI,IAAI,IAAI;AAC3B,cAAY,IAAI,MAAM;AACtB,OAAK,UAAU,IAAI,QAAQ,SAAS,GAAG,IAAI;AAC3C,MAAI,SAAS;AACb,WAAS,IAAI,GAAG,IAAI,QAAQ,QAAQ,KAAK,GAAG;AAC3C,UAAM,SAAS,KAAK,IAAI,IAAI,KAAK,IAAI,GAAG,QAAQ,CAAC,CAAC,CAAC;AACnD,SAAK,SAAS,QAAQ,SAAS,IAAI,SAAS,QAAS,SAAS,OAAQ,IAAI;AAC1E,cAAU;AAAA,EACV;AACD,SAAO;AACR;;;"}